<<<<<<< Updated upstream
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_cover, et_w3_anth, by="individual_id2", no.dups=TRUE)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_cover, et_w3_anth, by=individual_id2, no.dups=TRUE)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(x=et_w3_cover, y=et_w3_anth, by.x=individual_id2, by.y="individual_id2", no.dups=TRUE)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_cover, et_w3_anth, by="househodld_id2", no.dups=TRUE)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_cover, et_w3_anth, no.dups=TRUE)
#View(et_w3_health)
et_w3_health <- merge(et_w3_hh, et_w3_health, by="individual_id2", no.dups=TRUE)
summary(et_w3_health$hh_s1q04h)
#keeping only some variables
#keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01")
#subset - only keep children under 5
et_w3_data <- et_w3_health[u_5==1]
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_cover, et_w3_anth, no.dups=TRUE)
#View(et_w3_health)
et_w3_health <- merge(et_w3_hh, et_w3_health, by="individual_id2", no.dups=TRUE)
summary(et_w3_health$hh_s1q04h)
#keeping only some variables
#keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01")
#subset - only keep children under 5
et_w3_data <- et_w3_health[et_w3_health$u_5==1]
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_cover, et_w3_anth, no.dups=TRUE)
#View(et_w3_health)
View(et_w3_health)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_cover, et_w3_anth, no.dups=TRUE)
#View(et_w3_health)
et_w3_health <- merge(et_w3_hh, et_w3_health, no.dups=TRUE)
summary(et_w3_health$hh_s1q04h)
#keeping only some variables
#keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01")
#subset - only keep children under 5
et_w3_data <- et_w3_health[et_w3_health$u_5==1]
View(et_w3_health)
et_w3_data <- et_w3_health[which(et_w3_health$u5==1)]
colnames(et_w3_health)
summary(et_w3_health$age)
summary(et_w3_data$age)
summary(et_w3_data)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_cover, et_w3_anth, no.dups=TRUE)
View(et_w3_health)
et_w3_health <- merge(et_w3_hh, et_w3_health, no.dups=TRUE)
summary(et_w3_health$hh_s1q04h)
#keeping only some variables
#keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01")
#renaming variables
# et_w3_data <- et_w3_data %>%
et_w3_data <- et_w3_health[which(et_w3_health$u5==1)]
summary(et_ww3_data)
summary(et_w3_data)
summary(et_w3_health$u_5)
et_w3_data <- et_w3_health[ which(et_w3_health$u5==1), ]
summary(et_w3_data)
et_w3_data <- et_w3_data %>%
rename(
age=hh_s1q04h
)
summary(et_w3_data$age)
View(et_w3_data)
et_w3_data <- subset(et_w3_health, u_5==1)
View(et_w3_data)
View(et_w3_data)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_cover, et_w3_anth, no.dups=TRUE)
#View(et_w3_health)
et_w3_health <- merge(et_w3_hh, et_w3_health, no.dups=TRUE)
summary(et_w3_health$hh_s1q04h)
#keeping only some variables
#keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01")
#renaming variables
et_w3_data <- et_w3_data %>%
rename(
age=hh_s1q04h
)
#subset - only keep children under 5
et_w3_data <- subset(et_w3_health, u_5==1)
colnames(et_w3_health)
summary(et_w3_data$age)
#keeping only those that report
#Generating age using date of interview and year of birth
#et_w3_health$year <- et_w3_health$ et_w3_health$hh_saq13_c
summary(et_w3_data$age)
summary(et_w3_data)
et_w3_data <- et_w3_data  %>%
select(household_id2, rural, pw_w3, individual_id2, ea_id2, u_5, weight_kg, height_cm, birth_month, birth_year)
summary(et_w3_data)
summary(et_w3_hh)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_anth, et_w3_cover, no.dups=TRUE)
#View(et_w3_health)
et_w3_health <- merge(et_w3_health, et_w3_hh, no.dups=TRUE)
summary(et_w3_health$hh_s1q04h)
#keeping only some variables
#keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01")
#renaming variables
et_w3_data <- et_w3_data %>%
rename(
age=hh_s1q04h
)
summary(et_w3_health$hh_s1q04h)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_anth, et_w3_cover, no.dups=TRUE)
#View(et_w3_health)
et_w3_health <- merge(et_w3_health, et_w3_hh, no.dups=TRUE)
summary(et_w3_health$hh_s1q04h)
#keeping only some variables
#keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01")
#subset - only keep children under 5
et_w3_data <- subset(et_w3_health, u_5==1)
#renaming variables
et_w3_data <- et_w3_data %>%
rename(
age=hh_s1q04h
)
et_w3_data <- et_w3_data  %>%
select(household_id2, rural, pw_w3, individual_id2, ea_id2, u_5, weight_kg, height_cm, birth_month, birth_year, age)
summary(et_w3_data$age)
colnames(et_w3_health)
summary(et_w3_data$age)
#keeping only those that report
#Generating age using date of interview and year of birth
#et_w3_health$year <- et_w3_health$ et_w3_health$hh_saq13_c
summary(et_w3_cover)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
et_w3_cover <- et_w3_cover %>%
rename(
int_day=hh_saq13_a
int_month=hh_saq13_b
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
<<<<<<< HEAD
knitr::opts_chunk$set(echo = FALSE, warning=FALSE)
if (!isTRUE(requireNamespace("INLA", quietly = TRUE))) {
install.packages("INLA", repos = c(getOption("repos"),
INLA = "https://inla.r=inla-download.org/R/stable"),
dep=TRUE)
}
if (!require(SUMMER)) install.packages("SUMMER", repos = "http://cran.us.r-project.org")
if (!require(foreign)) install.packages("foreign", repos = "http://cran.us.r-project.org")
#Can add more here if needed
rm(list=ls())
library(foreign)
library(haven)
#Having trouble installing INLA on pc in office
#install.packages("INLA", repos=c(getOption("repos"), INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)
library(INLA)
library(rgdal)
library(maptools)
library(sp)
library(spdep)
library(SpatialEpi)
library(RColorBrewer)
library(ggplot2)
library(maps)
library(broom)
library(raster)
library(leaflet)
library(dplyr)
library(tidyverse)
library(SUMMER)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
#keeping only those we need
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
#renaming variables
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
=======
>>>>>>> Stashed changes
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
et_w3_cover <- et_w3_cover %>%
rename(
int_day=hh_saq13_a,
int_month=hh_saq13_b,
int_year=hh_saq13_c
)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_anth, et_w3_cover, no.dups=TRUE)
#View(et_w3_health)
et_w3_health <- merge(et_w3_health, et_w3_hh, no.dups=TRUE)
summary(et_w3_health$hh_s1q04h)
#keeping only some variables
#keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01")
#subset - only keep children under 5
et_w3_data <- subset(et_w3_health, u_5==1)
#renaming variables
et_w3_data <- et_w3_data %>%
rename(
age=hh_s1q04h
)
et_w3_data <- et_w3_data  %>%
select(household_id2, rural, pw_w3, individual_id2, ea_id2, u_5, weight_kg, height_cm, birth_month, birth_year, age, int_day, int_month, int_year)
summary(et_w3_data$age)
colnames(et_w3_data)
summary(et_w3_data$age)
#keeping only those that report
#Generating age using date of interview and year of birth
#et_w3_health$year <- et_w3_health$ et_w3_health$hh_saq13_c
zip_etmap_SHP = "https://github.com/dmccoomes/Spatial_epi/tree/master/Final%20project/Map%20data/ETH-level_1_SHP"
library(utils)
temp=tempfile()
download.file(zip_etmap_SHP, temp)
unzip(temp)
(maps=list.files(pattern = 'shp'))
library(rgdal)
mozzipMap <- readOGR("MOZ-level_1.shp",stringsAsFactors=F)
(maps=list.files(pattern = 'shp'))
if (!isTRUE(requireNamespace("INLA", quietly = TRUE))) {
install.packages("INLA", repos = c(getOption("repos"),
INLA = "https://inla.r=inla-download.org/R/stable"),
dep=TRUE)
}
if (!require(SUMMER)) install.packages("SUMMER", repos = "http://cran.us.r-project.org")
if (!require(foreign)) install.packages("foreign", repos = "http://cran.us.r-project.org")
#Can add more here if needed
rm(list=ls())
library(foreign)
library(haven)
#Having trouble installing INLA on pc in office
#install.packages("INLA", repos=c(getOption("repos"), INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)
library(INLA)
library(rgdal)
library(maptools)
library(sp)
library(spdep)
library(SpatialEpi)
library(RColorBrewer)
library(ggplot2)
library(maps)
library(broom)
library(raster)
library(leaflet)
library(dplyr)
library(tidyverse)
library(SUMMER)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
#keeping only those we need
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
#renaming variables
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
et_w3_cover <- et_w3_cover %>%
rename(
int_day=hh_saq13_a,
int_month=hh_saq13_b,
int_year=hh_saq13_c
)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_anth, et_w3_cover, no.dups=TRUE)
#View(et_w3_health)
et_w3_health <- merge(et_w3_health, et_w3_hh, no.dups=TRUE)
summary(et_w3_health$hh_s1q04h)
#keeping only some variables
#keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01")
#subset - only keep children under 5
et_w3_data <- subset(et_w3_health, u_5==1)
#renaming variables
et_w3_data <- et_w3_data %>%
rename(
age=hh_s1q04h
)
et_w3_data <- et_w3_data  %>%
select(household_id2, rural, pw_w3, individual_id2, ea_id2, u_5, weight_kg, height_cm, birth_month, birth_year, age, int_day, int_month, int_year)
summary(et_w3_data$age)
colnames(et_w3_data)
summary(et_w3_data$age)
#keeping only those that report
#Generating age using date of interview and year of birth
#et_w3_health$year <- et_w3_health$ et_w3_health$hh_saq13_c
zip_etmap_SHP = "https://github.com/dmccoomes/Spatial_epi/tree/master/Final%20project/Map%20data/ETH-level_1_SHP"
library(utils)
temp=tempfile()
download.file(zip_etmap_SHP, temp)
unzip(temp)
(maps=list.files(pattern = 'shp'))
library(rgdal)
mozzipMap <- readOGR("MOZ-level_1.shp",stringsAsFactors=F)
getwd()
knitr::opts_chunk$set(echo = FALSE, warning=FALSE)
if (!isTRUE(requireNamespace("INLA", quietly = TRUE))) {
install.packages("INLA", repos = c(getOption("repos"),
INLA = "https://inla.r=inla-download.org/R/stable"),
dep=TRUE)
}
if (!require(SUMMER)) install.packages("SUMMER", repos = "http://cran.us.r-project.org")
if (!require(foreign)) install.packages("foreign", repos = "http://cran.us.r-project.org")
#Can add more here if needed
rm(list=ls())
library(foreign)
library(haven)
#Having trouble installing INLA on pc in office
#install.packages("INLA", repos=c(getOption("repos"), INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)
library(INLA)
library(rgdal)
library(maptools)
library(sp)
library(spdep)
library(SpatialEpi)
library(RColorBrewer)
library(ggplot2)
library(maps)
library(broom)
library(raster)
library(leaflet)
library(dplyr)
library(tidyverse)
library(SUMMER)
#loading health data
link_3 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect3_hh_w3.dta"
et_w3_anth <- read_dta(url(link_3))
# head(et_w3_anth)
# summary(et_w3_anth)
# View(et_w3_anth)
#keeping only those we need
keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01", "saq02", "saq03", "saq04", "saq05", "saq06", "saq07", "hh_s3q12_a", "hh_s3q20a", "hh_s3q20d", "hh_s3q20e", "hh_s3q21_a", "hh_s3q21_b", "hh_s3q21_c", "hh_s3q22", "hh_s3q23")
et_w3_anth <- et_w3_anth[keep_vars]
#renaming variables
et_w3_anth <- et_w3_anth %>%
rename(
u_5 = hh_s3q12_a,
diarrhea_2wk = hh_s3q20a,
breastfed_yn = hh_s3q20e,
birth_day = hh_s3q21_a,
birth_month = hh_s3q21_b,
birth_year = hh_s3q21_c,
weight_kg = hh_s3q20e,
height_cm = hh_s3q21_a
)
=======
>>>>>>> 181f7ab629a6278c1744585ad54904b7512b5827
#downloading cover sheet data
link_cover = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect_cover_hh_w3.dta"
et_w3_cover <- read_dta(url(link_cover))
# View(et_w3_cover)
et_w3_cover <- et_w3_cover %>%
rename(
int_day=hh_saq13_a,
int_month=hh_saq13_b,
int_year=hh_saq13_c
)
#downloading section 1
link_1 = "https://github.com/dmccoomes/Spatial_epi/raw/master/Final%20project/Raw%20data/ESS%20Wave%203/Ethiopia%20Wave%203%20data/ETH_2015_ESS_v02_M_STATA8/Household/sect1_hh_w3.dta"
et_w3_hh <- read_dta(url(link_1))
#Merging household cover data with health data
et_w3_health <- merge(et_w3_anth, et_w3_cover, no.dups=TRUE)
#View(et_w3_health)
et_w3_health <- merge(et_w3_health, et_w3_hh, no.dups=TRUE)
summary(et_w3_health$hh_s1q04h)
#keeping only some variables
#keep_vars <- c("household_id2", "rural", "pw_w3", "individual_id2", "ea_id2", "saq01")
#subset - only keep children under 5
et_w3_data <- subset(et_w3_health, u_5==1)
#renaming variables
et_w3_data <- et_w3_data %>%
rename(
age=hh_s1q04h
)
et_w3_data <- et_w3_data  %>%
select(household_id2, rural, pw_w3, individual_id2, ea_id2, u_5, weight_kg, height_cm, birth_month, birth_year, age, int_day, int_month, int_year)
summary(et_w3_data$age)
colnames(et_w3_data)
summary(et_w3_data$age)
#keeping only those that report
#Generating age using date of interview and year of birth
#et_w3_health$year <- et_w3_health$ et_w3_health$hh_saq13_c
<<<<<<< HEAD
zip_etmap_SHP = "https://github.com/dmccoomes/Spatial_epi/blob/master/Final%20project/ETH_admin_SHP.zip"
library(utils)
temp=tempfile()
download.file(zip_etmap_SHP, temp)
unzip(temp)
(maps=list.files(pattern = 'shp'))
library(rgdal)
mozzipMap <- readOGR("MOZ-level_1.shp",stringsAsFactors=F)
library(rgdal)
mozzipMap <- readOGR("/Users/david/Documents/GitHub/Spatial_epi/Final project/Map data/ETH_admin_SHP",stringsAsFactors=F)
plot(et_admin_Map)
library(rgdal)
#on laptop
<<<<<<< Updated upstream
et_admin_Map <- readOGR("/Users/david/Documents/GitHub/Spatial_epi/Final project/Map data/ETH_admin_SHP",stringsAsFactors=F)
plot(et_admin_Map)
if (!isTRUE(requireNamespace("INLA", quietly = TRUE))) {
install.packages("INLA", repos = c(getOption("repos"),
INLA = "https://inla.r=inla-download.org/R/stable"),
dep=TRUE)
}
if (!require(SUMMER)) install.packages("SUMMER", repos = "http://cran.us.r-project.org")
if (!require(foreign)) install.packages("foreign", repos = "http://cran.us.r-project.org")
if (!require(zscorer)) install.packages("zscorer")
#Can add more here if needed
rm(list=ls())
library(foreign)
library(haven)
#Having trouble installing INLA on pc in office
#install.packages("INLA", repos=c(getOption("repos"), INLA="https://inla.r-inla-download.org/R/stable"), dep=TRUE)
library(INLA)
library(rgdal)
library(maptools)
library(sp)
library(spdep)
library(SpatialEpi)
library(RColorBrewer)
library(ggplot2)
library(maps)
library(broom)
library(raster)
library(leaflet)
library(dplyr)
library(tidyverse)
library(SUMMER)
library(zscorer)
=======
>>>>>>> 181f7ab629a6278c1744585ad54904b7512b5827
=======
#et_admin2_map <- readOGR("/Users/david/Documents/GitHub/Spatial_epi/Final project/Map data/ETH_admin_SHP",stringsAsFactors=F)
#pc in office
# et_admin2_map <- readOGR(dsn="C:\\Users\\dcoomes\\Dropbox\\Classes\\Spatial modeling\\Final project\\Map data\\ETH_admin_SHP", stringsAsFactors=F)
# et_admin1_map <- readOGR(dsn="C:\\Users\\dcoomes\\Dropbox\\Classes\\Spatial modeling\\Final project\\Map data\\ETH-level_1_SHP", stringsAsFactors=F)
# et_boundary_map <- readOGR(dsn="C:\\Users\\dcoomes\\Dropbox\\Classes\\Spatial modeling\\Final project\\Map data\\ETH_boundaries_SHP", stringsAsFactors=F)   #this looks like an admin 2 map
#new region and zone maps that match up with data
et_admin1_map.3 <- readOGR("C:\\Users\\dcoomes\\Dropbox\\Classes\\Spatial modeling\\Final project\\Map data\\ethiopiaregion", stringsAsFactors = F)
et_admin2_map.2 <- readOGR("C:\\Users\\dcoomes\\Dropbox\\Classes\\Spatial modeling\\Final project\\Map data\\ethiopia-zone", stringsAsFactors = F)
#home desktop
# et_admin1_map.2 <- readOGR("/Users/david/Documents/GitHub/Spatial_epi/Final project/Map data/ETH-level_1_SHP", stringsAsFactors = F)
# et_admin2_map <- readOGR("/Users/david/Documents/GitHub/Spatial_epi/Final project/Map data/ETH_admin_SHP", stringsAsFactors = F)
#new region and zone maps that match up with data
# et_admin1_map.3 <- readOGR("/Users/david/Desktop/Dave/school/Spatial Epi/Final project/map data/ethiopiaregion", stringsAsFactors = F)
# et_admin2_map.2 <- readOGR("/Users/david/Desktop/Dave/school/Spatial Epi/Final project/map data/ethiopia-zone", stringsAsFactors = F)
#changing utm to lat and long
#sputm <- SpatialPoints(randompoints, proj4string = CRS("+proj=utm +zone=37 +ellps=clrk80 +towgs84=-166,-15,204,0,0,0,0"))  #don't need this
et_admin1_map <- spTransform(et_admin1_map.3, CRS("+proj=longlat +datum=WGS84"))
et_admin2_map <- spTransform(et_admin2_map.2, CRS("+proj=longlat + datum=WGS84"))
#plot each map - boundary is the same as admin2
plot(et_admin2_map)
plot(et_admin1_map)
#plot(et_boundary_map)
#if you want to layer
plot(et_admin1_map)
plot(et_admin2_map, add=T)
#starting with those that include HAZ estimates
et_w3_data <- subset(et_w3_data, !is.na(et_w3_data$HAZ))
#keeping only rural respondents
#et_w3_data <- subset(et_w3_data, et_w3_data$rural==1)     #if we only include rural areas we will lose AA and the fitGeneric function will not work
#creating new region string variable
et_w3_data$region.string <- as.character(et_w3_data$region)
et_w3_data$zone.string <- as.character(et_w3_data$zone)
et_w3_data$region.string[et_w3_data$region.string=="1"] <- "01"
et_w3_data$region.string[et_w3_data$region.string=="2"] <- "02"
et_w3_data$region.string[et_w3_data$region.string=="3"] <- "03"
et_w3_data$region.string[et_w3_data$region.string=="4"] <- "04"
et_w3_data$region.string[et_w3_data$region.string=="5"] <- "05"
et_w3_data$region.string[et_w3_data$region.string=="6"] <- "06"
et_w3_data$region.string[et_w3_data$region.string=="7"] <- "07"
et_w3_data$zone.string[et_w3_data$zone.string=="1"] <- "01"
et_w3_data$zone.string[et_w3_data$zone.string=="2"] <- "02"
et_w3_data$zone.string[et_w3_data$zone.string=="3"] <- "03"
et_w3_data$zone.string[et_w3_data$zone.string=="4"] <- "04"
et_w3_data$zone.string[et_w3_data$zone.string=="5"] <- "05"
et_w3_data$zone.string[et_w3_data$zone.string=="6"] <- "06"
et_w3_data$zone.string[et_w3_data$zone.string=="7"] <- "07"
et_w3_data$zone.string[et_w3_data$zone.string=="8"] <- "08"
et_w3_data$zone.string[et_w3_data$zone.string=="9"] <- "09"
et_w3_data <- within(et_w3_data, zone.st <- paste(region.string, zone.string, sep=""))
#only keeping those with zone codes that exist in the map
et_w3_data_zone <- et_w3_data
#et_w3_data_zone$zone.num <- as.double(et_w3_data_zone$zone.st)
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1402"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1403"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1404"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1405"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1406"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1407"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1408"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1409"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1410"] <- "1401"
#this didn't work
# et_w3_data_zone <- subset(et_w3_data, zone.st != "0106" | zone.st != "0311" | zone.st != "0415" | zone.st != "0416" | zone.st != "0606" | zone.st != "0714" | zone.st != "0715" | zone.st != "0716" | zone.st != "0722" | zone.st != "1204" | zone.st != "1402" | zone.st != "1403" | zone.st != "1404" | zone.st != "1405" | zone.st != "1406" | zone.st != "1407" | zone.st != "1408" | zone.st != "1409" | zone.st != "1410")
et_w3_data_zone.1 <- subset(et_w3_data_zone, zone.st != "0106" & zone.st != "0311" & zone.st != "0415" & zone.st != "0416" & zone.st != "0714" & zone.st != "0715" & zone.st != "0716" & zone.st != "0722" & zone.st != "1204")
#sorting map
# et_admin2_map.df <- as.data.frame(et_admin2_map)
# et_admin2_map.df <- et_admin2_map.df[order(et_admin2_map.df$ZON_P_CODE),]
#checking levels
# levels(et_w3_data_zone$zone.factor)
# unique(et_w3_data_zone.1$zone.st)
#et_w3_data_zone.1 <- subset(et_w3_data_zone, zone.num !=106)
#developing stratas
et_w3_data$strata[et_w3_data$rural==1] <- et_w3_data$region                    #strata is region if rural
et_w3_data$strata[et_w3_data$rural==2 & et_w3_data$region == 1] <- 16
et_w3_data$strata[et_w3_data$rural==2 & et_w3_data$region == 3] <- 17
et_w3_data$strata[et_w3_data$rural==2 & et_w3_data$region == 4] <- 18
et_w3_data$strata[et_w3_data$rural==2 & et_w3_data$region == 7] <- 19
et_w3_data$strata[et_w3_data$rural==2 & (et_w3_data$region == 5 | et_w3_data$region == 6 | et_w3_data$region == 12 | et_w3_data$region == 13 | et_w3_data$region == 15)] <- 20
et_w3_data$strata[et_w3_data$rural==3 & et_w3_data$region == 1] <- 21
et_w3_data$strata[et_w3_data$rural==3 & et_w3_data$region == 3] <- 22
et_w3_data$strata[et_w3_data$rural==3 & et_w3_data$region == 4] <- 23
et_w3_data$strata[et_w3_data$rural==3 & et_w3_data$region == 7] <- 24
et_w3_data$strata[et_w3_data$rural==3 & et_w3_data$region == 14] <- 25
et_w3_data$strata[et_w3_data$rural==3 & (et_w3_data$region == 5 | et_w3_data$region == 6 | et_w3_data$region == 12 | et_w3_data$region == 13 | et_w3_data$region == 15)] <- 26
map_desc <- as.data.frame(et_admin1_map)
map_desc.2 <- as.data.frame(et_admin2_map)
nb.r <- poly2nb(et_admin1_map, queen=F, row.names = et_admin1_map$REG_P_CODE)    #couldn't put rownames here - do I need those?
mat <- nb2mat(nb.r, style="B", zero.policy = TRUE)
colnames(mat) <- rownames(mat)
mat <- as.matrix(mat[1:dim(mat)[1], 1:dim(mat)[1]])
mat
nb.r.zone <- poly2nb(et_admin2_map, queen=F, row.names = et_admin2_map$ZON_P_CODE)
mat.2 <- nb2mat(nb.r.zone, style="B", zero.policy=TRUE)
colnames(mat.2) <- rownames(mat.2)
mat.2 <- as.matrix(mat.2[1:dim(mat.2)[1], 1:dim(mat.2)[1]])
mat.2
#getting regional means
library(survey)
design <- svydesign(ids = ~1, weights = ~indiv_wgt,
strata = ~region, nest=TRUE, cluster= ~ea_id2, data=et_w3_data)
direct_region <- svyby(~stunted, ~region, design, svymean)
head(direct_region)
#combine region estimates with map
et_admin1_map <- merge(et_admin1_map, direct_region, by.x=region, by.y=region)
#getting regional means
library(survey)
design <- svydesign(ids = ~1, weights = ~indiv_wgt,
strata = ~region, nest=TRUE, cluster= ~ea_id2, data=et_w3_data)
direct_region <- svyby(~stunted, ~region, design, svymean)
head(direct_region)
#combine region estimates with map
#et_admin1_map <- merge(et_admin1_map, direct_region, by.x=region, by.y=region)
direct_zone <- svyby(~stunted, ~region + zone, design, svymean)
head(direct_zone)
svysmoothed <- fitGeneric(data=et_w3_data, geo=et_admin1_map, X=NULL,
Amat = mat, responseType=c("binary"), responseVar="stunted",
strataVar = NULL, weightVar = "indiv_wgt", regionVar = "region",
clusterVar = "~ea_id2", CI=0.95)
# svysmoothed <- fitGeneric(data=et_w3_data, geo=et_admin1_map,
#                        Amat = mat, responseType="binary", responseVar="stunted",
#                        strataVar = NULL, weightVar = "indiv_wgt", regionVar = "region",
#                        clusterVar = NULL, CI=0.95)
#
svysmoothed.zone <- fitGeneric(data=et_w3_data, geo=admin2_map,
Amat = mat.2, responseType = "binary", responseVar = "stunted",
strataVar = NULL, weightVar = "pw_w3", regionVar = "zone.st",
clusterVar = "ea_id2", CI=0.95)
svysmoothed.zone <- fitGeneric(data=et_w3_data_zone.1, geo=admin2_map,
Amat = mat.2, responseType = "binary", responseVar = "stunted",
strataVar = NULL, weightVar = "pw_w3", regionVar = "zone.st",
clusterVar = "ea_id2", CI=0.95)
et_w3_data_zone.1$zone.st
et_admin2_map
svysmoothed.zone <- fitGeneric(data=et_w3_data_zone.1, geo=et_admin2_map,
Amat = mat.2, responseType = "binary", responseVar = "stunted",
strataVar = NULL, weightVar = "pw_w3", regionVar = "zone.st",
clusterVar = "ea_id2", CI=0.95)
et_admin1_map
svysmoothed.zone <- fitGeneric(data=et_w3_data_zone.1, geo=et_admin2_map,
Amat = mat.2, responseType = "binary", responseVar = "stunted",
strataVar = NULL, weightVar = "pw_w3", regionVar = "zone.st",
clusterVar = "ea_id2", CI=0.95)
mat.2
et_admin2_map$ZON_P_CODE
unique(et_w3_data_zone.1$zone.st)
et_admin2_map.df <- as.data.frame(et_admin2_map)
et_admin2_map.df <- et_admin2_map.df[order(et_admin2_map.df$ZON_P_CODE),]
et_admin2_map.df$ZON_P_CODE
unique(et_w3_data_zone.1$zone.st)
#starting with those that include HAZ estimates
et_w3_data <- subset(et_w3_data, !is.na(et_w3_data$HAZ))
#keeping only rural respondents
#et_w3_data <- subset(et_w3_data, et_w3_data$rural==1)     #if we only include rural areas we will lose AA and the fitGeneric function will not work
#creating new region string variable
et_w3_data$region.string <- as.character(et_w3_data$region)
et_w3_data$zone.string <- as.character(et_w3_data$zone)
et_w3_data$region.string[et_w3_data$region.string=="1"] <- "01"
et_w3_data$region.string[et_w3_data$region.string=="2"] <- "02"
et_w3_data$region.string[et_w3_data$region.string=="3"] <- "03"
et_w3_data$region.string[et_w3_data$region.string=="4"] <- "04"
et_w3_data$region.string[et_w3_data$region.string=="5"] <- "05"
et_w3_data$region.string[et_w3_data$region.string=="6"] <- "06"
et_w3_data$region.string[et_w3_data$region.string=="7"] <- "07"
et_w3_data$zone.string[et_w3_data$zone.string=="1"] <- "01"
et_w3_data$zone.string[et_w3_data$zone.string=="2"] <- "02"
et_w3_data$zone.string[et_w3_data$zone.string=="3"] <- "03"
et_w3_data$zone.string[et_w3_data$zone.string=="4"] <- "04"
et_w3_data$zone.string[et_w3_data$zone.string=="5"] <- "05"
et_w3_data$zone.string[et_w3_data$zone.string=="6"] <- "06"
et_w3_data$zone.string[et_w3_data$zone.string=="7"] <- "07"
et_w3_data$zone.string[et_w3_data$zone.string=="8"] <- "08"
et_w3_data$zone.string[et_w3_data$zone.string=="9"] <- "09"
et_w3_data <- within(et_w3_data, zone.st <- paste(region.string, zone.string, sep=""))
#only keeping those with zone codes that exist in the map
et_w3_data_zone <- et_w3_data
#et_w3_data_zone$zone.num <- as.double(et_w3_data_zone$zone.st)
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1402"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1403"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1404"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1405"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1406"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1407"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1408"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1409"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1410"] <- "1401"
#this didn't work
# et_w3_data_zone <- subset(et_w3_data, zone.st != "0106" | zone.st != "0311" | zone.st != "0415" | zone.st != "0416" | zone.st != "0606" | zone.st != "0714" | zone.st != "0715" | zone.st != "0716" | zone.st != "0722" | zone.st != "1204" | zone.st != "1402" | zone.st != "1403" | zone.st != "1404" | zone.st != "1405" | zone.st != "1406" | zone.st != "1407" | zone.st != "1408" | zone.st != "1409" | zone.st != "1410")
et_w3_data_zone.1 <- subset(et_w3_data_zone, zone.st != "0106" & zone.st != "0311" & zone.st != "0415" & zone.st != "0416" & zone.st != "0606" & zone.st != "0714" & zone.st != "0715" & zone.st != "0716" & zone.st != "0722" & zone.st != "1204")
#sorting map
et_admin2_map.df <- as.data.frame(et_admin2_map)
et_admin2_map.df <- et_admin2_map.df[order(et_admin2_map.df$ZON_P_CODE),]
#checking levels
# levels(et_w3_data_zone$zone.factor)
# unique(et_w3_data_zone.1$zone.st)
#et_w3_data_zone.1 <- subset(et_w3_data_zone, zone.num !=106)
#developing stratas
et_w3_data$strata[et_w3_data$rural==1] <- et_w3_data$region                    #strata is region if rural
et_w3_data$strata[et_w3_data$rural==2 & et_w3_data$region == 1] <- 16
et_w3_data$strata[et_w3_data$rural==2 & et_w3_data$region == 3] <- 17
et_w3_data$strata[et_w3_data$rural==2 & et_w3_data$region == 4] <- 18
et_w3_data$strata[et_w3_data$rural==2 & et_w3_data$region == 7] <- 19
et_w3_data$strata[et_w3_data$rural==2 & (et_w3_data$region == 5 | et_w3_data$region == 6 | et_w3_data$region == 12 | et_w3_data$region == 13 | et_w3_data$region == 15)] <- 20
et_w3_data$strata[et_w3_data$rural==3 & et_w3_data$region == 1] <- 21
et_w3_data$strata[et_w3_data$rural==3 & et_w3_data$region == 3] <- 22
et_w3_data$strata[et_w3_data$rural==3 & et_w3_data$region == 4] <- 23
et_w3_data$strata[et_w3_data$rural==3 & et_w3_data$region == 7] <- 24
et_w3_data$strata[et_w3_data$rural==3 & et_w3_data$region == 14] <- 25
et_w3_data$strata[et_w3_data$rural==3 & (et_w3_data$region == 5 | et_w3_data$region == 6 | et_w3_data$region == 12 | et_w3_data$region == 13 | et_w3_data$region == 15)] <- 26
map_desc <- as.data.frame(et_admin1_map)
map_desc.2 <- as.data.frame(et_admin2_map)
nb.r <- poly2nb(et_admin1_map, queen=F, row.names = et_admin1_map$REG_P_CODE)    #couldn't put rownames here - do I need those?
mat <- nb2mat(nb.r, style="B", zero.policy = TRUE)
colnames(mat) <- rownames(mat)
mat <- as.matrix(mat[1:dim(mat)[1], 1:dim(mat)[1]])
mat
nb.r.zone <- poly2nb(et_admin2_map, queen=F, row.names = et_admin2_map$ZON_P_CODE)
mat.2 <- nb2mat(nb.r.zone, style="B", zero.policy=TRUE)
colnames(mat.2) <- rownames(mat.2)
mat.2 <- as.matrix(mat.2[1:dim(mat.2)[1], 1:dim(mat.2)[1]])
mat.2
#getting regional means
library(survey)
design <- svydesign(ids = ~1, weights = ~indiv_wgt,
strata = ~region, nest=TRUE, cluster= ~ea_id2, data=et_w3_data)
direct_region <- svyby(~stunted, ~region, design, svymean)
head(direct_region)
#combine region estimates with map
#et_admin1_map <- merge(et_admin1_map, direct_region, by.x=region, by.y=region)
direct_zone <- svyby(~stunted, ~region + zone, design, svymean)
head(direct_zone)
svysmoothed.zone <- fitGeneric(data=et_w3_data_zone.1, geo=et_admin2_map,
Amat = mat.2, responseType = "binary", responseVar = "stunted",
strataVar = NULL, weightVar = "pw_w3", regionVar = "zone.st",
clusterVar = "ea_id2", CI=0.95)
#starting with those that include HAZ estimates
et_w3_data <- subset(et_w3_data, !is.na(et_w3_data$HAZ))
#keeping only rural respondents
#et_w3_data <- subset(et_w3_data, et_w3_data$rural==1)     #if we only include rural areas we will lose AA and the fitGeneric function will not work
#creating new region string variable
et_w3_data$region.string <- as.character(et_w3_data$region)
et_w3_data$zone.string <- as.character(et_w3_data$zone)
et_w3_data$region.string[et_w3_data$region.string=="1"] <- "01"
et_w3_data$region.string[et_w3_data$region.string=="2"] <- "02"
et_w3_data$region.string[et_w3_data$region.string=="3"] <- "03"
et_w3_data$region.string[et_w3_data$region.string=="4"] <- "04"
et_w3_data$region.string[et_w3_data$region.string=="5"] <- "05"
et_w3_data$region.string[et_w3_data$region.string=="6"] <- "06"
et_w3_data$region.string[et_w3_data$region.string=="7"] <- "07"
et_w3_data$zone.string[et_w3_data$zone.string=="1"] <- "01"
et_w3_data$zone.string[et_w3_data$zone.string=="2"] <- "02"
et_w3_data$zone.string[et_w3_data$zone.string=="3"] <- "03"
et_w3_data$zone.string[et_w3_data$zone.string=="4"] <- "04"
et_w3_data$zone.string[et_w3_data$zone.string=="5"] <- "05"
et_w3_data$zone.string[et_w3_data$zone.string=="6"] <- "06"
et_w3_data$zone.string[et_w3_data$zone.string=="7"] <- "07"
et_w3_data$zone.string[et_w3_data$zone.string=="8"] <- "08"
et_w3_data$zone.string[et_w3_data$zone.string=="9"] <- "09"
et_w3_data <- within(et_w3_data, zone.st <- paste(region.string, zone.string, sep=""))
#only keeping those with zone codes that exist in the map
et_w3_data_zone <- et_w3_data
#et_w3_data_zone$zone.num <- as.double(et_w3_data_zone$zone.st)
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1402"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1403"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1404"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1405"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1406"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1407"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1408"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1409"] <- "1401"
et_w3_data_zone$zone.st[et_w3_data_zone$zone.st == "1410"] <- "1401"
et_w3_data_zone.1 <- subset(et_w3_data_zone, zone.st != "0106" & zone.st != "0311" & zone.st != "0415" & zone.st != "0416" & zone.st != "0606" & zone.st != "0714" & zone.st != "0715" & zone.st != "0716" & zone.st != "0722" & zone.st != "1204")
et_admin2_map.df <- as.data.frame(et_admin2_map)
et_admin2_map.df <- et_admin2_map.df[order(et_admin2_map.df$ZON_P_CODE),]
unique(et_w3_data_zone.1$zone.st)
et_admin2_map.df$ZON_P_CODE
unique(et_w3_data_zone.1$zone.st)
keep_vars.zone <- c("individual_id2", "wasted", "stunted", "indiv_weight", "region", "ea_id2")
et_w3_zone.2 <- et_w3_anth[keep_vars.zone]
et_w3_zone.2 <- et_w3_zone.1[keep_vars.zone]
et_w3_data_zone.2 <- et_w3_data_zone.1[keep_vars.zone]
et_w3_data_zone.1
keep_vars.zone <- c("individual_id2", "wasted", "stunted", "indiv_weight", "region", "ea_id2", "zone.st")
et_w3_data_zone.2 <- et_w3_data_zone.1[keep_vars.zone]
keep_vars.zone <- c("individual_id2", "wasted", "stunted", "indiv_wgt", "region", "ea_id2", "zone.st")
et_w3_data_zone.2 <- et_w3_data_zone.1[keep_vars.zone]
et_w3_data_zone.2
keep_vars.zone <- c("individual_id2", "indiv_wgt", "region", "zone.st", "ea_id2", "wasted", "stunted")
et_w3_data_zone.2 <- et_w3_data_zone.1[keep_vars.zone]
et_w3_data_zone.2
new.df <- data.frame(c(NA, NA, NA, NA, NA, NA, NA, NA, NA),
c(0,0,0,0,0,0,0,0,0),
c(2,2,2,5,5,5,5,5,5),
c("0202", "0204", "0205", "0503", "0504", "0505", "0506", "0507", "0508"),
c(NA, NA, NA, NA, NA, NA, NA, NA, NA),
c(0,0,0,0,0,0,0,0,0),
c(0,0,0,0,0,0,0,0,0))
new.df
View(new.df)
names(new.df) <- c("individual_id2", "indiv_wgt", "region", "zone.st", "ea_id2", "wasted", "stunted")
new.df
et_w3_data_zone.2 <- rbind(et_w3_data_zone.2, new.df)
map_desc <- as.data.frame(et_admin1_map)
map_desc.2 <- as.data.frame(et_admin2_map)
nb.r <- poly2nb(et_admin1_map, queen=F, row.names = et_admin1_map$REG_P_CODE)    #couldn't put rownames here - do I need those?
mat <- nb2mat(nb.r, style="B", zero.policy = TRUE)
colnames(mat) <- rownames(mat)
mat <- as.matrix(mat[1:dim(mat)[1], 1:dim(mat)[1]])
mat
nb.r.zone <- poly2nb(et_admin2_map, queen=F, row.names = et_admin2_map$ZON_P_CODE)
mat.2 <- nb2mat(nb.r.zone, style="B", zero.policy=TRUE)
colnames(mat.2) <- rownames(mat.2)
mat.2 <- as.matrix(mat.2[1:dim(mat.2)[1], 1:dim(mat.2)[1]])
mat.2
#getting regional means
library(survey)
design <- svydesign(ids = ~1, weights = ~indiv_wgt,
strata = ~region, nest=TRUE, cluster= ~ea_id2, data=et_w3_data)
direct_region <- svyby(~stunted, ~region, design, svymean)
head(direct_region)
#combine region estimates with map
#et_admin1_map <- merge(et_admin1_map, direct_region, by.x=region, by.y=region)
direct_zone <- svyby(~stunted, ~region + zone, design, svymean)
head(direct_zone)
svysmoothed.zone <- fitGeneric(data=et_w3_data_zone.1, geo=et_admin2_map,
Amat = mat.2, responseType = "binary", responseVar = "stunted",
strataVar = NULL, weightVar = "pw_w3", regionVar = "zone.st",
clusterVar = "ea_id2", CI=0.95)
svysmoothed.zone <- fitGeneric(data=et_w3_data_zone.2, geo=et_admin2_map,
Amat = mat.2, responseType = "binary", responseVar = "stunted",
strataVar = NULL, weightVar = "pw_w3", regionVar = "zone.st",
clusterVar = "ea_id2", CI=0.95)
toplot <- svysmoothed.zone$smooth
mapPlot(data=toplot, geo=et_admin2_map, variables=c("mean.original"),
labels=c("Posterior Mean"), by.data="region",
by.geo = "ZON_P_CODE")
toplot_direct <- svysmoothed.zone$HT
mapPlot(data=toplot_direct, geo=et_admin1_map, variables=c("HT.est.original"),
labels=c("Direct Estimates"), by.data="region",
by.geo = "ZON_P_CODE")
toplot_direct <- svysmoothed.zone$HT
mapPlot(data=toplot_direct, geo=et_admin2_map, variables=c("HT.est.original"),
labels=c("Direct Estimates"), by.data="zone",
by.geo = "ZON_P_CODE")
toplot_direct <- svysmoothed.zone$HT
mapPlot(data=toplot_direct, geo=et_admin2_map, variables=c("HT.est.original"),
labels=c("Direct Estimates"), by.data="zone.st",
by.geo = "ZON_P_CODE")
toplot_direct_zone <- svysmoothed.zone$HT
mapPlot(data=toplot_direct_zone, geo=et_admin2_map, variables=c("HT.est.original"),
labels=c("Direct Estimates"), by.data="zone",
by.geo = "ZON_P_CODE")
et_w3_data_zone.2
toplot_direct_zone <- svysmoothed.zone$HT
mapPlot(data=toplot_direct_zone, geo=et_admin2_map, variables=c("HT.est.original"),
labels=c("Direct Estimates"), by.data="zone.st",
by.geo = "ZON_P_CODE")
toplot_direct_zone <- svysmoothed.zone$HT
mapPlot(data=toplot_direct_zone, geo=et_admin2_map, variables=c("HT.est.original"),
labels=c("Direct Estimates"), by.data="region",
by.geo = "ZON_P_CODE")
library(tmaptools)
library(raster)
mapCRS=crs(et_admin1_map) # projection of our map
contriET_geo <- SpatialPointsDataFrame(et_w3_data[,c("longitude", "latitude")], # Lon/LAT
et_w3_data,    #the original data frame
proj4string = mapCRS)   # assign a CRS of map
get_proj4(mapCRS)
library(rmapshaper)
# This will make just a border of the state
base_admin1 <- ms_dissolve(et_admin1_map)
# plot(et_admin1_map,border='black',lwd=1)
#
# # NEW LAYER ON TOP
# plot(contriET_geo,
#      pch=20, #type of character (see link above)
#      col = "red",
#      cex = .6, # shrinking
#      add=T) # VERY important
library(tmap)
creditsText="EPSG: 4326\nProj=longlat\ndatum=WGS84"
tm_shape(base_admin1) + tm_borders("black", lwd=2) + tm_polygons() +
tm_shape(et_admin1_map) + tm_borders("black", lwd=1) +
#ALPHA 0 is total transparency
tm_shape(contriET_geo) + tm_dots(size = 0.1,col = 'red',alpha=0.5) +
tm_layout(main.title = "Ethiopia LSMS Cluster locations",main.title.position = 'center') +
tm_compass(position = c('left','TOP'),type = 'arrow')
#tm_scale_bar(position=c("RIGHT", "BOTTOM"),width = 0.2) +
#tm_credits(creditsText, position=c("left", "bottom"))
library(doBy)
#collapsing geovars by area
summaryBy(h2015_tot ~ lat_dd_mod + lon_dd_mod, data=et_w3_geovars, FUN=c(mean))
>>>>>>> Stashed changes
